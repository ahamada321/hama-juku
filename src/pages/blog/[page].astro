---
import Layout from '@src/layouts/Layout.astro';
import BlogSection from '@components/BlogSection.astro';
import { blogPosts } from '@src/data/BlogItems';
import HeadingPage from '@components/HeadingPage.astro';

export async function getStaticPaths() {
  const postsPerPage = 3;
  const totalPosts = blogPosts.length;
  const totalPages = Math.ceil(totalPosts / postsPerPage);
  return Array.from({ length: totalPages }, (_, i) => ({
    params: { page: (i + 1).toString() },
  }));
}

const { page } = Astro.params;
const currentPage = parseInt(page);
const postsPerPage = 3;
const totalPosts = blogPosts.length;
const totalPages = Math.ceil(totalPosts / postsPerPage);
const start = (currentPage - 1) * postsPerPage;
const posts = blogPosts.slice(start, start + postsPerPage);

if (!posts.length) {
  return Astro.redirect('/404');
}
---

<Layout title={ page === '1' ? 'Latest Blogs' : `Page ${currentPage} - Latest Blogs`}>
    <HeadingPage
        title={ page === '1' ? 'Latest Blogs' : `Page ${currentPage} - Latest Blogs`}
        description="Explore our insights on design trends, tips, and creative inspiration to elevate your projects." />
  <BlogSection
    posts={posts}
    currentPage={currentPage}
    totalPages={totalPages}
    baseUrl="/blog/"
  />
</Layout>